import sys
import codecs

input_file = 'D:/Ushur/VAPT/Internal_Security_Testing/File_Upload/IP S3 Upload/Create_Ushur_Crash.xlsx'
output_file = 'D:/Ushur/VAPT/Internal_Security_Testing/File_Upload/IP S3 Upload/encoded.txt'

if len(sys.argv) > 1:
    input_file = sys.argv[1]
    input_file = input_file.replace("\\", '/')

BLOCKSIZE = 1048576 # or some other, desired size in bytes
with codecs.open(input_file, "r", "iso-8859-1") as sourceFile:
    with codecs.open(output_file, "w", "utf-8") as targetFile:
        while True:
            contents = sourceFile.read(BLOCKSIZE)
            if not contents:
                break
            targetFile.write(contents)